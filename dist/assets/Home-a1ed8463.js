import{u as p,a as r,j as t,L as x,R as h,F as g,r as d}from"./index-0d8f2245.js";import{u as v,g as N,B as y,a as I}from"./uuid-f26bd5c5.js";function R({img:n,name:e,population:a,region:s,capital:i}){const{t:c}=p();return r("li",{className:"country-item",tabIndex:0,children:[t("img",{src:n,loading:"lazy",tabIndex:0,alt:`${e}'s flag`,className:"country-img",width:"267",height:"160"}),r("div",{className:"country-inner",children:[t("h3",{className:"country-title",tabIndex:0,children:e}),r("ul",{className:"country-info-list",children:[r("li",{className:"country-info-item",tabIndex:0,title:`${e}'s population is ${a}`,children:[c("population"),": ",t("span",{className:"country-special-info",children:a})]}),r("li",{className:"country-info-item",tabIndex:0,title:`${e}'s region is ${s}`,children:[c("region"),": ",t("span",{className:"country-special-info",children:s})]}),r("li",{className:"country-info-item",tabIndex:0,title:`${e}'s capital is ${i}`,children:[c("capital"),": ",t("span",{className:"country-special-info",children:i})]}),t("li",{children:t(x,{className:"country-link",title:`See more info about ${e}`,to:`country/${e}`,children:c("link")})})]})]})]})}function $({countries:n}){return t("ul",{className:"card-list",children:n.map(e=>t(R,{name:e.name.common,capital:e.capital||"No capital city",img:e.flags.svg,population:e.population,region:e.region},v()))})}function S(n,e=1e3){let a;return(...s)=>{clearTimeout(a),a=setTimeout(()=>{n(...s)},e)}}const b=h.forwardRef(({countries:n,setCountries:e,setError:a},s)=>{const{t:i,i18next:c}=p(),m=S(async l=>{const u=s.current.value,o=u.trim()?`name/${u}`:"all";console.log(o);const f=await N(y,o);if(!Array.isArray(f))return e([]),a(!0);localStorage.setItem("inputValue",u),e(f)});return t(g,{children:t("input",{className:"search-input",defaultValue:localStorage.getItem("inputValue"),"aria-label":"search for countries",id:"searchInput",type:"search",ref:s,onChange:m,placeholder:i("search"),required:!0})})});const A=h.forwardRef(({countries:n,setCountries:e},a)=>{const{t:s,i18n:i}=p();return r("select",{className:"region-select",name:"user_filter",id:"regionFilter",onChange:async m=>{const l=a.current.value,u=l?`region/${l}`:"all",o=await N(y,u);e(o)},ref:a,children:[t("option",{value:"",children:s("filter")}),t("option",{value:"africa",children:"Africa"}),t("option",{value:"ame",children:"America"}),t("option",{value:"asia",children:"Asia"}),t("option",{value:"europe",children:"Europe"}),t("option",{value:"oceania",children:"Oceania"})]})});function C({countries:n,setCountries:e,setError:a}){const s=d.exports.useRef(),i=d.exports.useRef();return r("form",{className:"site-form",action:"#",children:[t(b,{ref:s,setError:a,countries:n,setCountries:e}),t(A,{ref:i,setError:a,countries:n,setCountries:e})]})}function F(){const n=JSON.parse(localStorage.getItem("countries")),[e,a]=d.exports.useState(n||[]),[s,i]=d.exports.useState(!0),[c,m]=d.exports.useState(!1),{t:l,i18n:u}=p();return d.exports.useMemo(async()=>{if(n)return i(!1);try{const o=await I();a(o)}catch{m(!0)}finally{i(!1)}},[]),t(g,{children:t("section",{className:"countries",children:r("div",{className:"container",children:[t(C,{countries:e,setCountries:a,setError:m}),s?t("h2",{className:"site-state",children:l("loading")}):"",c?t("h2",{className:"site-state",children:l("error")}):"",e?t($,{countries:e}):""]})})})}export{F as default};
